---
title: JS基础 - 函数
author: essviv
date: 2017-02-04 08:56:00+0800
tags:
	- js
	- function
---

### 函数的定义

定义函数和定义普通变量没有太大的区别，只是在指定值的时候，使用的是个function对象而已，如下： 
````javascript
示例:

var square = function(x){
	return x * x;
}
````

### 变量的作用域

函数的参数变量以及在函数体中以var关键字声明的变量，均为局部变量，也就是说这些变量仅在函数内部可见，而在函数体外声明的变量，可以认为是全局变量

在JS中，除了局部变量和全局变量，还存在作用域嵌套的情况. 简单来讲，**每个局部作用域都可以看到包含它的所有作用域变量, 函数可见的变量集合取决于函数在程序中所处的位置.**

另外，在JS中，**只有函数才会产生新的作用域**，其它的代码块，即使用大括号包起来，也不会产生新的作用域

````javascript
var sth = 1;
{
	var sth = 2; //这里并没有产生新的作用域
}
````

### 调用堆栈

调用堆栈中存储了函数执行的上下文(context),当调用函数时，程序会将当前调用环境的上下文入堆，当函数返回时，则从堆顶弹出相应的上下文以恢复函数调用前的环境. 

### 函数参数

在JS中，函数参数的个数并不是严格限制的，

* 如果传入的参数多于函数定义的参数个数，那么多出来的参数会被自动忽略；

* 如果传入的参数个数少于函数定义的参数个数，那么没有传入的那些参数会被自动填充为undefined

````javascript
function add(a, b){
}

例1: add(1) ===>  b为undefined
例2: add(1, 2, 3) ===> 参数3被忽略
````

### 闭包

结合“函数局部变量对外不可见”以及“函数可以存储于变量中”这两个事实，可以得到一个很有意思的问题： 

> 如果在访问局部变量的时候，局部变量所处的函数变量已经出了作用域了，那么局部变量会是什么样的状态？

````javascript
//这里定义了一个闭包
function wrapValue(n){
	var localValue = n;
	return function(){return localValue;}
}

var wrap1 = wrapValue(1);
var wrap2 = wrapValue(2);

console.log(wrap1()); //1
console.log(wrap2()); //2
````

以上的例子说明，局部变量仍然是可见的，这种情况就被称为是“闭包”.使用这个特性可以写出一些很有意思的代码.